--THIS TRIGGER SAVES THE CHANGED COLUMN IN EMP_1 TO A LOG TABLE LOG_TRIAL1 AFTER UPDATE--
--HERE ONLY THREE COLUMNS ARE AUDITED FIRST_NAME,LAST_NAME AND SALARY--
--THE TRIGGER USES IF THEN CLAUSES TO IDENTIFY THE CHANGE--
CREATE OR REPLACE TRIGGER TRG_EMP_1
   AFTER UPDATE ON EMP_1
   FOR EACH ROW
DECLARE
   V_USERNAME VARCHAR2(20);
   V_TABLE_NAME VARCHAR2(20);
BEGIN
   V_TABLE_NAME:='EMP_1';
   SELECT USER INTO V_USERNAME FROM DUAL;
   IF( UPDATING( 'FIRST_NAME' ) )
   THEN
      INSERT INTO LOG_TRIAL1(TABLE_NAME,COLUMN_NAME,USERNAME,OLD_VALUE,NEW_VALUE,EMP_ID)
         VALUES(V_TABLE_NAME,'FIRST_NAME',V_USERNAME,:old.FIRST_NAME,:new.FIRST_NAME,:old.EMPLOYEE_ID );
    --COMMIT;
   END IF;
   --
   IF( UPDATING( 'LAST_NAME' ) )
   THEN
      INSERT INTO LOG_TRIAL1(TABLE_NAME,COLUMN_NAME,USERNAME,OLD_VALUE,NEW_VALUE,EMP_ID)
         VALUES(V_TABLE_NAME,'LAST_NAME',V_USERNAME,:old.LAST_NAME,:new.LAST_NAME,:old.EMPLOYEE_ID );
    --COMMIT;
   END IF;
   --
   IF( UPDATING( 'SALARY' ) )
   THEN
      INSERT INTO LOG_TRIAL1(TABLE_NAME,COLUMN_NAME,USERNAME,OLD_VALUE,NEW_VALUE,EMP_ID)
         VALUES( V_TABLE_NAME,'SALARY',V_USERNAME,:old.SALARY,:new.SALARY,:old.EMPLOYEE_ID );
    --COMMIT;
   END IF;
END;


